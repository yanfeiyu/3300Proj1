<html>

<head>
<title>Min Zheng (mz474)</title>
<script src="http://d3js.org/d3.v4.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/d3-legend/2.13.0/d3-legend.js"></script>

<link href='https://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>
<link href='https://fonts.googleapis.com/css?family=Open+Sans+Condensed:300' rel='stylesheet' type='text/css'>

<!-- <script type="text/javascript" src="js/script.js">
</script> -->

<!-- <script src="jquery-3.3.1.min.js"></script> -->
<script src="https://d3js.org/d3.v4.min.js"></script>
<script src="http://d3js.org/topojson.v2.min.js"></script>
<!-- <link rel="stylesheet" type="text/css" href="all.css" media="all" /> -->
<style>
body {
  font-family: "Open Sans Condensed"; text-align: center; }
h1 {
  font-family: "Open Sans Condensed";
  text-transform: uppercase;
  font-weight: 200;
  font-size: 36pt;
  padding: 0;
  margin: 0;
}


div {
  margin: 30px;
}
h3{
  text-align:center;
  margin-top:20px;
}
svg { border: solid #ccc 1px; }


.text{
  width:650px;
  margin:auto;
  margin-bottom:30px;
  font-size:13px;
}



</style>
</head>

</style>

<body>
  <h1>Gender and Mental Health</h1>

  <div id="gender">
    <div class="gender-text text">
      explain text
    </div>

  </div>

  <h1>causuals for unhappiness</h1>

  <div id="casuals" class = "causual">
    <div class="causual casuals-text">
      explain text
    </div>
  </div>


  <script>
 // plot 1
  var genderSvg = d3.select("#gender").append("svg")
    .attr("id","genderSvg")
    .attr("width","600")
    .attr("height","500");


// construct path for male
var humanPath = genderSvg.append("clipPath")
.attr("id","humanPath");


var cigar_1 = humanPath.append("path")
.attr("d","M28.325 16.822V21.392L22.949 29.514 17.573 37.654 17.611 87.786 17.669 137.936 33.682 137.994 49.694 138.032 49.618 127.338 49.541 116.624 50.712 116.566 51.883 116.509 51.998 123.574C52.075 127.453 52.133 132.31 52.133 134.326V138.032H69.797V37.443L64.997 30.205 60.197 22.947V12.272H28.325V16.822ZM59.813 23.005C59.813 23.734 59.909 24.214 60.082 24.349 60.312 24.541 59.64 25.654 56.05 31.069L51.749 37.558V67.568H49.253V39.536H19.685V37.04L34.334 37.002 48.965 36.944 53.093 30.704 57.24 24.464 43.109 24.368 28.997 24.272 28.939 23.062 28.882 21.872H59.813V23.005ZM52.133 106.717C52.133 108.483 52.075 110.346 52.018 110.845L51.883 111.728H49.637V103.472H52.133V106.717ZM329.189 19.856V27.44L337.022 27.478 344.837 27.536 344.894 29.974 344.952 32.432H357.029V37.04H353.63L353.515 41.494C353.438 43.952 353.381 46.64 353.381 47.446V48.944H357.797V37.424H359.717V48.944H363.922L363.979 43.126C364.018 39.939 364.018 35.754 363.979 33.814L363.941 30.32H357.029V19.76H345.509V12.272H329.189V19.856ZM142.181 16.208V19.568H122.405V29.936H113.957V49.136H121.08L120.965 66.934C120.907 76.746 120.83 96.637 120.773 111.171L120.658 137.61 137.035 137.725C146.04 137.802 157.79 137.878 163.128 137.898L172.843 137.936 172.958 133.923C173.035 131.715 173.093 127.798 173.093 125.226V120.56H184.363L184.478 111.478C184.555 106.506 184.613 92.509 184.613 80.374V58.352H173.285V49.136H182.693V25.136H178.085V12.848H142.181V16.208ZM168.485 50.288V51.44H142.181V49.136H168.485V50.288ZM178.795 72.118C178.718 75.69 178.661 86.403 178.661 95.926V113.264H173.093V99.958C173.093 92.662 173.15 81.949 173.227 76.15L173.342 65.648H178.91L178.795 72.118ZM133.925 87.152V105.2H131.429V69.104H133.925V87.152ZM148.325 76.746C148.325 80.95 148.267 89.072 148.19 94.794L148.075 105.2H145.579L145.694 97.962C145.771 93.987 145.829 85.866 145.829 79.914V69.104H148.325V76.746ZM162.859 74.71C162.782 77.802 162.725 85.923 162.725 92.758V105.2H160.229V95.926C160.229 90.838 160.286 82.717 160.363 77.878L160.478 69.104H162.974L162.859 74.71ZM232.421 20.432V28.016L240.254 28.054 248.069 28.112 248.126 30.55 248.184 33.008H260.261V38H231.845L231.883 42.454 231.941 46.928 246.398 46.986 260.837 47.024V38H267.173V30.896H260.261V20.528L254.462 20.49 248.645 20.432 248.587 16.63 248.549 12.848H232.421V20.432ZM311.333 42.992V48.944H351.653V37.04H311.333V42.992ZM231.883 93.814 231.941 137.936 246.398 137.994 260.837 138.032V49.712H231.845L231.883 93.814ZM311.064 74.422C311.006 87.19 310.91 106.602 310.853 117.603L310.757 137.59 321.278 137.706C327.058 137.782 338.827 137.84 347.429 137.859H363.077L363.134 129.872 363.173 121.904H374.443L374.558 117.43C374.635 114.992 374.693 101.955 374.712 88.496L374.731 64.016 369.048 63.958 363.365 63.92V51.498L348.926 51.382C340.997 51.306 329.246 51.248 322.853 51.248H311.179L311.064 74.422ZM368.875 81.334C368.798 87.133 368.741 97.059 368.741 103.414V114.992H363.173V107.158C363.173 102.858 363.23 92.931 363.307 85.078L363.422 70.832H368.99L368.875 81.334ZM324.005 90.704V107.504H321.509V91.587C321.509 82.851 321.566 75.286 321.624 74.787L321.758 73.904H324.005V90.704ZM338.405 85.482C338.405 91.856 338.347 99.421 338.27 102.282L338.155 107.504H335.659L335.774 105.334C335.851 104.163 335.909 96.598 335.909 88.534V73.904H338.405V85.482ZM352.901 74.096C352.958 74.192 352.958 81.757 352.882 90.896L352.747 107.504H350.251L350.366 94.966C350.443 88.093 350.501 80.528 350.501 78.166V73.904H351.634C352.267 73.904 352.843 73.981 352.901 74.096Z");








// stacked bars
// data and data processing

// healthy
//drink, no smoke
//smoke, no drink

//drink and smoke

var habbit_data = [
  {  1: 0.564, 2: 0.141, 3: 0.087, 4: 0.045, 5: 0.163},
  {  1: 0.555, 2: 0.143, 3: 0.084, 4: 0.054, 5: 0.164},
{  1: 0.367, 2: 0.141, 3: 0.116, 4: 0.066, 5: 0.311},
{  1: 0.351, 2: 0.153, 3: 0.123, 4: 0.067, 5: 0.307},

];


// d3.csv("gender.csv")
// .row(function(d){return {"SEX": d.SEX, "level": d.meng6days, "percent": d.freq}})
// .get(function(error, row) {
//   if(error) throw error;



  var stack = d3.stack()
  .keys(["5", "4", "3", "2", "1"])
  //"1", "2", "3", "4", "5"

  var stacked = stack(habbit_data);

  // plotting stack
  var height = 250;
  var width = genderSvg.attr("width");

  var maxY = d3.max(stacked, function(d) {
  return d3.max(d, function(d) {
  return d[1];
  });
  });


  var x = d3.scaleLinear()
    .range([0, 100])
    .domain([0,1]);


  //y scale
  var yStart = 12;
  var y = d3.scaleLinear()
  .domain([0, maxY])
  .range([yStart+125.76, yStart]);


  //var color = d3.scaleOrdinal(d3.schemeCategory10);
  var colorScale = d3.scaleLinear()
  .domain([0,4])
  .range(['#164480','#A0D1FA']);


  // bind a <g> tag for each layer
  var male_layers = genderSvg.selectAll('g.male_layers')
  .data(stacked, function(d) { return d.key; })
  .enter()
  .append('g')
  .attr('class', 'male_layers')
  .attr('fill', function(d, i) { return colorScale(i); })

var right_padding = 200;
  // bind a <rect> to each value inside the layer
  var male_bars = male_layers.selectAll('male_layers')
  .data(function(d) { return d; })
  .enter()
  .append('rect')
  .attr('x', function(d, i) {
      return x(i);})
  .attr('width', (width - right_padding)/4)
  .attr('y', (function(d) {
  return y(d[1]);}))
  .attr('height', function(d) {
  return y(d[0]) - y(d[1]);
  })
  // .attr("clip-path","url(#fmPath)")
  .attr("clip-path","url(#humanPath)");


  var textScale = d3.scaleLinear()
  .domain([0,4])
  .range(["1-6","7-12", "13-18", "19-24", "25-30"]);


var colorList = [];
for (var i = 0; i <= 4; i++) {
  colorList.push(colorScale(i));
}
  var legendScale = d3.scaleOrdinal()
  .domain(["1-6","7-12", "13-18", "19-24", "25-30"])
  .range(colorList.reverse());
  // .range(['#A0D1FA','#A0D1FA','#A0D1FA','#A0D1FA','#164480']);

//add lengend
  var genderLegend = d3.legendColor()
        .labelFormat(d3.format(".0f"))
        .scale(legendScale)
        .shapePadding(5)
        .shapeWidth(50)
        .shapeHeight(20)
        .labelOffset(12);

        genderSvg.append("g")
        .attr("transform", function(d, i) { return "translate(500," + (i * 20 + 20)+ ")"; })
        .call(genderLegend);



// })






// genderSvg.append('g')
//   .attr('class', 'legend')
//   .selectAll('text')
//   .data(function(d) { return d; })
//   .enter()
//   .append('text')
//   .text(function(d) { return 'â€¢ ' + d.key; })
//   .attr('fill', function(d) { return color(d.key); })
//           .attr('y', function(d, i) { return 20 * (i + 1); })


// // bind a <g> tag for each layer
// var fm_layers = genderSvg.selectAll('g.fm_layers')
// .data(stacked, function(d) { return d.key; })
// .enter()
// .append('g')
// .attr('class', 'fm_layers')
// .attr('fill', function(d, i) { return colorScale(i); })
//
// // bind a <rect> to each value inside the layer
// var fm_bars = fm_layers.selectAll('fm_layers')
// .data(function(d) { return d; })
// .enter()
// .append('rect')
// .attr('x', 300)
// .attr('width', width / 4)
// .attr('y', (function(d) {
// return y(d[1]);}))
// .attr('height', function(d) {
// return y(d[0]) - y(d[1]);
// })
// .attr("clip-path","url(#fmPath)");




//.attr("clip-path","url(#fmPath)");


//bars.transform("translate","(0, 40)")

//https://square.github.io/intro-to-d3/examples/


</script>


<script>
// plot 2
var cauSvg = d3.select("#casuals").append("svg")
  .attr("id","genderSvg")
  .attr("width","600")
  .attr("height","1000");


  var unhappy = [
  {"days":1,"Sleep":8,"Support":93},
  {"days":2,"Sleep":8,"Support":93},
  {"days":3,"Sleep":8.5,"Support":86},
  {"days":4,"Sleep":7.5,"Support":87},
  {"days":5,"Sleep":7,"Support":54},
  {"days":6,"Sleep":6,"Support":37},
  {"days":7,"Sleep":6.5,"Support":15},
  {"days":8,"Sleep":7.5,"Support":87},
  {"days":9,"Sleep":7,"Support":54},
  {"days":10,"Sleep":6,"Support":37},
  {"days":11,"Sleep":8,"Support":93},
  {"days":12,"Sleep":8,"Support":93},
  {"days":13,"Sleep":8.5,"Support":86},
  {"days":14,"Sleep":7.5,"Support":87},
  {"days":15,"Sleep":7,"Support":54},
  {"days":16,"Sleep":6,"Support":37},
  {"days":17,"Sleep":6.5,"Support":15},
  {"days":18,"Sleep":7.5,"Support":87},
  {"days":19,"Sleep":7,"Support":54},
  {"days":20,"Sleep":6,"Support":37},
  {"days":21,"Sleep":8,"Support":93},
  {"days":22,"Sleep":8,"Support":93},
  {"days":23,"Sleep":8.5,"Support":86},
  {"days":24,"Sleep":7.5,"Support":87},
  {"days":25,"Sleep":7,"Support":54},
  {"days":26,"Sleep":6,"Support":37},
  {"days":27,"Sleep":6.5,"Support":15},
  {"days":28,"Sleep":7.5,"Support":87},
  {"days":29,"Sleep":7,"Support":54},
  {"days":30,"Sleep":6,"Support":37}
  ];

  cauSvg.append("text")
  .attr("x", 170).attr("y", 20)
  .style("fill", "#ccc")
  .text("2018");


  var width = cauSvg.attr("width");
  var height = cauSvg.attr("height");
  var sleepScale = d3.scaleLinear()
  .domain([5,10])
  .range([width/2, width-30]); // start at the middle, end near (but not at) the right margin

  var dayScale = d3.scaleLinear()
  .domain([1,30]) // using the length of the longer array
  .range([20, height-20]);


  var supportScale = d3.scaleLinear()
  .domain([0,100])
  // .domain([d3.min(unhappy, function(d) { return d.Sleep; }),
  // d3.max(unhappy, function(d) { return d.Sleep; })])
  .range([30, width/2]); // start at the middle, end near (but not at) the right margin


var opScale =  d3.scaleLinear()
.domain([1,30]) // using the length of the longer array
.range([0.4, 1]);

  unhappy.forEach(function (d, i) {
    cauSvg.append("line")
    .attr("x1", width/2)
    .attr("x2", sleepScale(d.Sleep)) // shorter than what we did in class (via CI)
    .attr("y1", dayScale(i)) // For the height, use the index
    .attr("y2", dayScale(i))
    .style("stroke", "#25A7F0")
    .style("stroke-width", 10)
    .style("opacity", opScale(i));


    cauSvg.append("line")
    .attr("x1", width/2 - supportScale(d.Support))
    .attr("x2", width/2)
    .attr("y1", dayScale(i)) // For the height, use the index
    .attr("y2", dayScale(i))
    .style("stroke", "#FA7471")
    .style("stroke-width", 20)
    .style("opacity", opScale(i));
  });



</script>
