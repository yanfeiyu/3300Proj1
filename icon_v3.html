<html>

<head>
<title>Min Zheng (mz474)</title>
<script src="http://d3js.org/d3.v4.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/d3-legend/2.25.5/d3-legend.js"></script>

<link href='https://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>
<link href='https://fonts.googleapis.com/css?family=Open+Sans+Condensed:300' rel='stylesheet' type='text/css'>

<!-- <script type="text/javascript" src="js/script.js">
</script> -->

<!-- <script src="jquery-3.3.1.min.js"></script> -->
<script src="https://d3js.org/d3.v4.min.js"></script>
<script src="http://d3js.org/topojson.v2.min.js"></script>
<!-- <link rel="stylesheet" type="text/css" href="all.css" media="all" /> -->
<style>
body {
  font-family: "Open Sans Condensed"; text-align: center; }
h1 {
  font-family: "Open Sans Condensed";
  text-transform: uppercase;
  font-weight: 200;
  font-size: 36pt;
  padding: 0;
  margin: 0;
}


div {
  margin: 30px;
}
h3{
  text-align:center;
  margin-top:20px;
}
svg { border: solid #ccc 1px; }


.text{
  width:650px;
  margin:auto;
  margin-bottom:30px;
  font-size:13px;
}



</style>
</head>

</style>

<body>
  <h1>Gender and Mental Health</h1>

  <div id="gender">
    <div class="gender-text text">
      explain text
    </div>

  </div>

  <h1>causuals for unhappiness</h1>

  <div id="casuals" class = "causual">
    <div class="causual casuals-text">
      explain text
    </div>
  </div>


  <script>
 // plot 1
  var genderSvg = d3.select("#gender").append("svg")
    .attr("id","genderSvg")
    .attr("width","600")
    .attr("height","500");


// construct path for male
var humanPath = genderSvg.append("clipPath")
.attr("id","humanPath");


// var male_head = humanPath.append("path")
// .attr("d","m130.4 14.887c-7.4 7.4-13.475 13.6-13.475 13.725 0 .15 6.125 6.375 13.625 13.875l13.625 13.625 13.65-13.65 13.65-13.65-13.35-13.35c-7.325-7.35-13.55-13.5-13.8-13.7-.4-.325-1.575.775-13.925 13.125z");
//
//
// var male_body = humanPath.append("path")
// .attr("d","m-118.05.55c-7.375 7.375-13.425 13.55-13.425 13.675 0 .15 6.125 6.375 13.625 13.875l13.625 13.625 13.5-13.5c7.425-7.425 13.5-13.6 13.5-13.75 0-.25-27-27.375-27.25-27.375-.075 0-6.175 6.05-13.575 13.45z");
//
//
// var fm = humanPath.append("path")
// .attr("d","m-10.925 102.05 0 59.5 7.575-.05 7.55-.075.075-18.1c.05-14.125.125-18.175.375-18.325.4-.25 18.45-.25 18.85 0 .25.15 .325 4.2.375 18.325l.075 18.1 7.025.075 7.025.05 .125-59.3c.075-32.625.1-59.4.025-59.525-.05-.1-11.125-.175-24.6-.175l-24.475 0 0 59.5z");

var fm = humanPath.append("path")
.attr("d","M158.4 23.887C151 31.287 144.925 37.488 144.925 37.613 144.925 37.762 151.05 43.988 158.55 51.488L172.175 65.113 185.825 51.463 199.475 37.813 186.125 24.462C178.8 17.113 172.575 10.962 172.325 10.762 171.925 10.438 170.75 11.537 158.4 23.887ZM40.35 24.438C32.975 31.813 26.925 37.988 26.925 38.113 26.925 38.262 33.05 44.488 40.55 51.988L54.175 65.613 67.675 52.113C75.1 44.688 81.175 38.512 81.175 38.363 81.175 38.113 54.175 10.988 53.925 10.988 53.85 10.988 47.75 17.037 40.35 24.438ZM29.425 126.488 29.425 185.988 37 185.938 44.55 185.863 44.625 167.763C44.675 153.638 44.75 149.588 45 149.438 45.4 149.188 63.45 149.188 63.85 149.438 64.1 149.588 64.175 153.638 64.225 167.763L64.3 185.863 71.325 185.938 78.35 185.988 78.475 126.688C78.55 94.063 78.575 67.288 78.5 67.163 78.45 67.063 67.375 66.988 53.9 66.988L29.425 66.988 29.425 126.488ZM162.05 67.788C161.975 67.963 161.9 75.938 161.85 85.488L161.8 102.863 160.225 107.238C159.35 109.637 158.225 112.913 157.675 114.488 157.125 116.063 156 119.338 155.175 121.738 154.35 124.137 153.225 127.413 152.675 128.988 152.125 130.563 151 133.838 150.175 136.238 149.35 138.638 148.225 141.913 147.675 143.488 147.125 145.063 146 148.338 145.175 150.738 144.35 153.138 143.225 156.413 142.675 157.988 142.125 159.563 141 162.838 140.175 165.238 139.35 167.638 138.225 170.913 137.675 172.488 137.125 174.063 136 177.338 135.175 179.738 133.3 185.088 133.175 185.488 133.175 186.038 133.175 186.463 135.175 186.488 173.975 186.438 213.225 186.363 214.8 186.338 214.875 185.913 214.925 185.663 214.725 184.838 214.45 184.088 214.15 183.338 213.7 182.088 213.4 181.288 213.1 180.513 212.775 179.638 212.675 179.363 212.475 178.888 212.15 177.963 210.925 174.613 209.7 171.263 209.375 170.338 209.175 169.863 208.975 169.388 208.65 168.463 207.425 165.113 207.15 164.363 206.7 163.113 206.425 162.363 205.2 159.013 204.875 158.088 204.675 157.613 204.475 157.138 204.15 156.213 202.925 152.863 201.7 149.513 201.375 148.588 201.175 148.113 200.975 147.638 200.65 146.713 199.425 143.363 198.225 140.038 197.875 139.088 197.675 138.613 197.575 138.338 197.35 137.713 197.175 137.238 197 136.763 196.775 136.138 196.675 135.863 196.475 135.388 196.125 134.438 194.925 131.113 193.7 127.762 193.375 126.838 193.175 126.363 192.975 125.887 192.65 124.963 191.425 121.613 190.2 118.262 189.875 117.338 189.675 116.863 189.475 116.387 189.15 115.463 187.925 112.113 187.65 111.363 187.2 110.113 186.925 109.363 185.35 105.012 185.275 104.813 184.7 103.413 184.5 102.913 184.425 97.637 184.425 85.413 184.425 72.262 184.35 68.012 184.125 67.788 183.675 67.338 162.2 67.363 162.05 67.788Z");








// var male_body = humanPath.append("path")
// .attr("d","M148 149.6c-8 2.5-19.9 14.8-24.7 25.5-4.7 10.3-5 13.8-5 57.6 0 44.1.1 44.7 5.2 48.3 4.5 3.2 11.1 1.4 14-3.7 1-1.6 1.4-12.8 1.8-42.9.3-22.3.8-41 1.3-41.4.4-.4 1-.4 1.5 0 .4.4 .9 47.9 1.2 105.5.5 97.8.6 104.9 2.3 107.4 2.7 4.2 6.4 6.1 11.7 6.1 5.3 0 9-1.9 11.7-6.1 1.7-2.5 1.8-7.2 2-59.8.2-31.3.6-58.1.9-59.5.5-2.4.6-2.4 1.7-.5.9 1.4 1.3 18.4 1.7 60.7l.5 58.6 2.4 2.6c5.3 5.7 15 5.4 20.6-.4l3-3.1.5-105.4c.3-57.9.8-105.7 1.3-106.1.4-.4 1-.4 1.5 0 .4.4 .9 19.1 1.2 41.4.4 30.1.8 41.3 1.8 42.9 2.9 5.1 9.5 6.9 14 3.7 5.1-3.6 5.2-4.2 5.2-48.3 0-25.9-.4-43-1.1-46.3-2.6-12.8-12.4-27-23.1-33.9-5-3.3-5.6-3.4-13.5-3.1-14.9.5-24.7.5-31.8-.1-3.8-.4-8.3-.2-9.8.3z");
//
// var male_head = humanPath.append("circle")
// .attr("cx", "173")
// .attr("cy", "120")
// .attr("r", "30");
//
// // construct path for female
// // var fmPath = genderSvg.append("clipPath")
// // .attr("id","fmPath");
//
// var fm_head = humanPath.append("path")
// .attr("d","M333.9 104.1c-5.6.8-7.9 2-13.1 6.7-11.3 10.2-11.7 27.4-.8 38.2 16.8 16.9 44.9 5.1 45-18.8 0-17-13.8-28.6-31.1-26.1z");
//
// var fm_lleg = humanPath.append("path")
// .attr("d","M315.8 343.6c-5.6 3-5.8 4.5-5.8 38.4 0 25.8.3 31.6 1.5 34 4.1 8 18.9 8 23 0 2-3.9 2.2-64.1.1-67.8-3.1-5.7-12.6-8-18.8-4.6zM315.8 343.6c-5.6 3-5.8 4.5-5.8 38.4 0 25.8.3 31.6 1.5 34 4.1 8 18.9 8 23 0 2-3.9 2.2-64.1.1-67.8-3.1-5.7-12.6-8-18.8-4.6z");
//
//
// var fm_body = humanPath.append("path")
// .attr("d",
// "M346.5 160.6c-5.8 1.2-8.3 1.3-14.2.3-10.1-1.6-16.5-.8-21.6 2.7-9 6.3-18.9 22-24.1 37.9-4.2 12.8-19.7 82.3-19 85.1.8 3.1 5 6.4 8.2 6.4 3.9 0 8.7-3.6 11-8.2 1.2-2.4 3.3-10.2 4.8-17.3 5.9-29.7 12.5-59.7 13.6-62 1.7-3.7 2.8-3 2.8 1.5 0 2.2-5.4 29.9-12 61.5-6.6 31.7-12 58.7-12 60.1 0 1.5 1.2 3.8 2.9 5.5l2.9 2.9 48.5 0 48.5 0 3.1-2.6c2.5-2 3.1-3.4 3.1-6.3 0-2.1-5.2-28.5-11.5-58.7-12.3-58.7-13.7-67-11.4-66.2 2.2.7 3.5 5.7 11.4 43.3 4 19.2 7.8 36.1 8.3 37.5 2.8 7.2 12.8 11.4 17.1 7.1 1.1-1.1 2.3-3.2 2.7-4.7.9-3.4-17.7-85-21.7-95.5-1.6-4.2-4.8-10.3-7-13.5-11.1-16-19.3-20-34.4-16.8z");
//
// var fm_rleg = humanPath.append("path")
// .attr("d","M348.5 343c-1.1.4-3.1 2-4.53.5l-2.5 2.7 0 33 0 33 3.9 3.5c3.6 3.3 4.1 3.5 9.7 3.1 6.5-.5 9.3-2.3 11.5-7.5 2.1-4.8 2-59.9 0-64.8-2.6-6.1-11.5-9.3-18.1-6.5z");


//
// var fm_body = fmPath.append("path")
// .attr("d", );
//
// var fm_head = fmPath.append("circle")
// .attr("cx", "373")
// .attr("cy", "120")
// .attr("r", "30");

// stacked bars
// data and data processing
var gender_data = [
{  1: 0.525, 2: 0.137, 3: 0.091, 4: 0.048, 5: 0.199},
{  1: 0.516, 2: 0.144, 3: 0.094, 4: 0.052, 5: 0.194}
];


// d3.csv("gender.csv")
// .row(function(d){return {"SEX": d.SEX, "level": d.meng6days, "percent": d.freq}})
// .get(function(error, row) {
//   if(error) throw error;



  var stack = d3.stack()
  .keys(["5", "4", "3", "2", "1"])
  //"1", "2", "3", "4", "5"

  var stacked = stack(gender_data);

  // plotting stack
  var height = 250;
  var width = genderSvg.attr("width");

  var maxY = d3.max(stacked, function(d) {
  return d3.max(d, function(d) {
  return d[1];
  });
  });


  var x = d3.scaleLinear()
    .range([0, 100])
    .domain([0,1]);

  //var x = [90, 300];
  //y scale
  var y = d3.scaleLinear()
  .domain([0, maxY])
  .range([185, 10]);


  //var color = d3.scaleOrdinal(d3.schemeCategory10);
  var colorScale = d3.scaleLinear()
  .domain([0,4])
  .range(['#164480','#A0D1FA']);


  // bind a <g> tag for each layer
  var male_layers = genderSvg.selectAll('g.male_layers')
  .data(stacked, function(d) { return d.key; })
  .enter()
  .append('g')
  .attr('class', 'male_layers')
  .attr('fill', function(d, i) { return colorScale(i); })

  // bind a <rect> to each value inside the layer
  var male_bars = male_layers.selectAll('male_layers')
  .data(function(d) { return d; })
  .enter()
  .append('rect')
  .attr('x', function(d, i) {
      return x(i);})
  .attr('width', width / 4)
  .attr('y', (function(d) {
  return y(d[1]);}))
  .attr('height', function(d) {
  return y(d[0]) - y(d[1]);
  })
  // .attr("clip-path","url(#fmPath)")
  .attr("clip-path","url(#humanPath)");

//add lengend
  var genderLegend = d3.legendColor()
        .labelFormat(d3.format(".0f"))
        .scale(colorScale)
        .shapePadding(5)
        .shapeWidth(50)
        .shapeHeight(20)
        .labelOffset(12);

        svg.append("g")
        .attr("transform", function(d, i) { return "translate(350," + (i * 20 + 300)+ ")"; })
        .call(genderLegend);



// })






// genderSvg.append('g')
//   .attr('class', 'legend')
//   .selectAll('text')
//   .data(function(d) { return d; })
//   .enter()
//   .append('text')
//   .text(function(d) { return 'â€¢ ' + d.key; })
//   .attr('fill', function(d) { return color(d.key); })
//           .attr('y', function(d, i) { return 20 * (i + 1); })


// // bind a <g> tag for each layer
// var fm_layers = genderSvg.selectAll('g.fm_layers')
// .data(stacked, function(d) { return d.key; })
// .enter()
// .append('g')
// .attr('class', 'fm_layers')
// .attr('fill', function(d, i) { return colorScale(i); })
//
// // bind a <rect> to each value inside the layer
// var fm_bars = fm_layers.selectAll('fm_layers')
// .data(function(d) { return d; })
// .enter()
// .append('rect')
// .attr('x', 300)
// .attr('width', width / 4)
// .attr('y', (function(d) {
// return y(d[1]);}))
// .attr('height', function(d) {
// return y(d[0]) - y(d[1]);
// })
// .attr("clip-path","url(#fmPath)");




//.attr("clip-path","url(#fmPath)");


//bars.transform("translate","(0, 40)")

//https://square.github.io/intro-to-d3/examples/


</script>


<script>
// plot 2
var cauSvg = d3.select("#casuals").append("svg")
  .attr("id","genderSvg")
  .attr("width","600")
  .attr("height","1000");


  var unhappy = [
  {"days":1,"Sleep":8,"Support":93},
  {"days":2,"Sleep":8,"Support":93},
  {"days":3,"Sleep":8.5,"Support":86},
  {"days":4,"Sleep":7.5,"Support":87},
  {"days":5,"Sleep":7,"Support":54},
  {"days":6,"Sleep":6,"Support":37},
  {"days":7,"Sleep":6.5,"Support":15},
  {"days":8,"Sleep":7.5,"Support":87},
  {"days":9,"Sleep":7,"Support":54},
  {"days":10,"Sleep":6,"Support":37},
  {"days":11,"Sleep":8,"Support":93},
  {"days":12,"Sleep":8,"Support":93},
  {"days":13,"Sleep":8.5,"Support":86},
  {"days":14,"Sleep":7.5,"Support":87},
  {"days":15,"Sleep":7,"Support":54},
  {"days":16,"Sleep":6,"Support":37},
  {"days":17,"Sleep":6.5,"Support":15},
  {"days":18,"Sleep":7.5,"Support":87},
  {"days":19,"Sleep":7,"Support":54},
  {"days":20,"Sleep":6,"Support":37},
  {"days":21,"Sleep":8,"Support":93},
  {"days":22,"Sleep":8,"Support":93},
  {"days":23,"Sleep":8.5,"Support":86},
  {"days":24,"Sleep":7.5,"Support":87},
  {"days":25,"Sleep":7,"Support":54},
  {"days":26,"Sleep":6,"Support":37},
  {"days":27,"Sleep":6.5,"Support":15},
  {"days":28,"Sleep":7.5,"Support":87},
  {"days":29,"Sleep":7,"Support":54},
  {"days":30,"Sleep":6,"Support":37}
  ];

  cauSvg.append("text")
  .attr("x", 170).attr("y", 20)
  .style("fill", "#ccc")
  .text("2018");


  var width = cauSvg.attr("width");
  var height = cauSvg.attr("height");
  var sleepScale = d3.scaleLinear()
  .domain([5,10])
  .range([width/2, width-30]); // start at the middle, end near (but not at) the right margin

  var dayScale = d3.scaleLinear()
  .domain([1,30]) // using the length of the longer array
  .range([20, height-20]);


  var supportScale = d3.scaleLinear()
  .domain([0,100])
  // .domain([d3.min(unhappy, function(d) { return d.Sleep; }),
  // d3.max(unhappy, function(d) { return d.Sleep; })])
  .range([30, width/2]); // start at the middle, end near (but not at) the right margin


var opScale =  d3.scaleLinear()
.domain([1,30]) // using the length of the longer array
.range([0.4, 1]);

  unhappy.forEach(function (d, i) {
    cauSvg.append("line")
    .attr("x1", width/2)
    .attr("x2", sleepScale(d.Sleep)) // shorter than what we did in class (via CI)
    .attr("y1", dayScale(i)) // For the height, use the index
    .attr("y2", dayScale(i))
    .style("stroke", "#25A7F0")
    .style("stroke-width", 10)
    .style("opacity", opScale(i));


    cauSvg.append("line")
    .attr("x1", width/2 - supportScale(d.Support))
    .attr("x2", width/2)
    .attr("y1", dayScale(i)) // For the height, use the index
    .attr("y2", dayScale(i))
    .style("stroke", "#FA7471")
    .style("stroke-width", 20)
    .style("opacity", opScale(i));
  });



</script>
